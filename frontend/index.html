<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Master</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&family=Noto+Sans:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
</head>
<body>
  <div class="layout-container">
    <header>
      <div class="logo-group">
        <img src="utilities/logo.png" alt="TaskMaster Logo" class="logo-icon">
        <span class="logo-text">TaskMaster</span>
      </div>
      <nav>
        <a href="#" id="go-to-todos-nav" style="display: none;">My Todos</a>
        <a href="#" id="logout-link-nav" style="display:none;">Logout</a>
      </nav>
      <button class="login-btn" onclick="location.href='pages/login.html'" style="display:none;" id="login-btn-header">Log in</button>
    </header>
    <main>
      <div class="layout-content-container">
        <h1 class="main-title">Welcome to TaskMaster</h1>
        <p class="main-desc">Unlock your productivity. Manage your tasks efficiently and stay organized with our intuitive platform.</p>
        <button class="get-started-btn" onclick="location.href='pages/signup.html'" id="get-started-btn-main">
          <span>Get Started</span>
          <span class="material-icons-outlined">arrow_forward</span>
        </button>
        <button id="go-to-todos-btn" class="go-to-todos-btn" style="display:none;">Go to My Todos</button>
      </div>
    </main>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const token = localStorage.getItem('token');
      const goToTodosNav = document.getElementById('go-to-todos-nav');
      const logoutLinkNav = document.getElementById('logout-link-nav');
      const loginBtnHeader = document.getElementById('login-btn-header');
      const getStartedBtnMain = document.getElementById('get-started-btn-main');
      const goToTodosBtn = document.getElementById('go-to-todos-btn');

      if (token) {
        // User is logged in
        if (logoutLinkNav) logoutLinkNav.style.display = 'inline';
        if (loginBtnHeader) loginBtnHeader.style.display = 'none';
        if (getStartedBtnMain) getStartedBtnMain.style.display = 'none'; 
        if (goToTodosBtn) goToTodosBtn.style.display = 'inline-block'; 

        if (goToTodosNav) {
          // Show "My Todos" nav link only if logged in AND on pages/todo.html
          // This means it will be hidden on index.html
          if (window.location.pathname.includes('pages/todo.html')) {
            goToTodosNav.style.display = 'inline';
          } else {
            goToTodosNav.style.display = 'none';
          }
        }
      } else {
        // User is not logged in
        if (logoutLinkNav) logoutLinkNav.style.display = 'none';
        if (loginBtnHeader) loginBtnHeader.style.display = 'inline-block'; 
        if (getStartedBtnMain) getStartedBtnMain.style.display = 'inline-block'; 
        if (goToTodosBtn) goToTodosBtn.style.display = 'none'; 
        if (goToTodosNav) goToTodosNav.style.display = 'none'; // Hide if not logged in
      }

      if (goToTodosNav) {
        goToTodosNav.addEventListener('click', function(e) {
          e.preventDefault();
          if (localStorage.getItem('token')) {
            window.location.href = 'pages/todo.html';
          } else {
            // This case should ideally not be reached if the link is hidden when not logged in
            window.location.href = 'pages/login.html';
          }
        });
      }

      if (goToTodosBtn) {
        goToTodosBtn.addEventListener('click', function() {
          // Assumes token is present because button is shown conditionally
          window.location.href = 'pages/todo.html';
        });
      }

      if (logoutLinkNav) {
        logoutLinkNav.addEventListener('click', function(e) {
          e.preventDefault();
          localStorage.removeItem('token');
          window.location.href = 'index.html'; 
        });
      }
    });
  </script>
</body>
</html>